{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Read the data from AURN"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Read the site data by a bounds of longitude and latitude\n",
    "\n",
    "Users can give a bounds of longitude and latitude to read the site data."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Load the OBSAQ package and Define the range"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 1,
   "metadata": {},
   "outputs": [],
   "source": [
    "import obsaq\n",
    "\n",
    "lon_min = -1\n",
    "lon_max = 2\n",
    "lat_min = 50\n",
    "lat_max = 55\n",
    "bounds=[lon_min, lon_max, lat_min, lat_max]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Get the station metadata\n",
    "\n",
    "NOTE: This is the all station information and the next step will choose the stations by bounds."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 2,
   "metadata": {},
   "outputs": [],
   "source": [
    "meta = obsaq.meta()\n",
    "site_table = meta.get_metadata('aurn')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Choose the stations by range"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Site is selected by bounds: [-1, 2, 50, 55]\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>site_id</th>\n",
       "      <th>site_name</th>\n",
       "      <th>location_type</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>parameter</th>\n",
       "      <th>Parameter_name</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>ratified_to</th>\n",
       "      <th>zone</th>\n",
       "      <th>agglomeration</th>\n",
       "      <th>local_authority</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>rownames</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>364</th>\n",
       "      <td>BDMP</td>\n",
       "      <td>Borehamwood Meadow Park</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>51.662332</td>\n",
       "      <td>-0.270001</td>\n",
       "      <td>NO</td>\n",
       "      <td>Nitric oxide</td>\n",
       "      <td>2017-10-01</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>2023-12-31</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hertsmere</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>365</th>\n",
       "      <td>BDMP</td>\n",
       "      <td>Borehamwood Meadow Park</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>51.662332</td>\n",
       "      <td>-0.270001</td>\n",
       "      <td>NO2</td>\n",
       "      <td>Nitrogen dioxide</td>\n",
       "      <td>2017-10-01</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>2023-12-31</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hertsmere</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>366</th>\n",
       "      <td>BDMP</td>\n",
       "      <td>Borehamwood Meadow Park</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>51.662332</td>\n",
       "      <td>-0.270001</td>\n",
       "      <td>NOXasNO2</td>\n",
       "      <td>Nitrogen oxides as nitrogen dioxide</td>\n",
       "      <td>2017-10-01</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>2023-12-31</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hertsmere</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>367</th>\n",
       "      <td>BDMP</td>\n",
       "      <td>Borehamwood Meadow Park</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>51.662332</td>\n",
       "      <td>-0.270001</td>\n",
       "      <td>PM10</td>\n",
       "      <td>PM10 particulate matter (Hourly measured)</td>\n",
       "      <td>2022-03-22</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>2023-12-31</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hertsmere</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>368</th>\n",
       "      <td>BDMP</td>\n",
       "      <td>Borehamwood Meadow Park</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>51.662332</td>\n",
       "      <td>-0.270001</td>\n",
       "      <td>PM2.5</td>\n",
       "      <td>PM2.5 particulate matter (Hourly measured)</td>\n",
       "      <td>2022-03-22</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>2023-12-31</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hertsmere</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         site_id                site_name     location_type   latitude  \\\n",
       "rownames                                                                 \n",
       "364         BDMP  Borehamwood Meadow Park  Urban Background  51.662332   \n",
       "365         BDMP  Borehamwood Meadow Park  Urban Background  51.662332   \n",
       "366         BDMP  Borehamwood Meadow Park  Urban Background  51.662332   \n",
       "367         BDMP  Borehamwood Meadow Park  Urban Background  51.662332   \n",
       "368         BDMP  Borehamwood Meadow Park  Urban Background  51.662332   \n",
       "\n",
       "          longitude parameter                              Parameter_name  \\\n",
       "rownames                                                                    \n",
       "364       -0.270001        NO                                Nitric oxide   \n",
       "365       -0.270001       NO2                            Nitrogen dioxide   \n",
       "366       -0.270001  NOXasNO2         Nitrogen oxides as nitrogen dioxide   \n",
       "367       -0.270001      PM10   PM10 particulate matter (Hourly measured)   \n",
       "368       -0.270001     PM2.5  PM2.5 particulate matter (Hourly measured)   \n",
       "\n",
       "          start_date end_date ratified_to     zone agglomeration  \\\n",
       "rownames                                                           \n",
       "364       2017-10-01  ongoing  2023-12-31  Eastern           NaN   \n",
       "365       2017-10-01  ongoing  2023-12-31  Eastern           NaN   \n",
       "366       2017-10-01  ongoing  2023-12-31  Eastern           NaN   \n",
       "367       2022-03-22  ongoing  2023-12-31  Eastern           NaN   \n",
       "368       2022-03-22  ongoing  2023-12-31  Eastern           NaN   \n",
       "\n",
       "         local_authority  \n",
       "rownames                  \n",
       "364            Hertsmere  \n",
       "365            Hertsmere  \n",
       "366            Hertsmere  \n",
       "367            Hertsmere  \n",
       "368            Hertsmere  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_sites = meta.get_site(bounds=bounds)\n",
    "final_sites.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Choose a site by `site_id` and read it directly\n"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "https://uk-air.defra.gov.uk/data_files/site_data/BDMP_2018.csv\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>time</th>\n",
       "      <th>Nitric oxide</th>\n",
       "      <th>status</th>\n",
       "      <th>unit</th>\n",
       "      <th>Nitrogen dioxide</th>\n",
       "      <th>status.1</th>\n",
       "      <th>unit.1</th>\n",
       "      <th>Nitrogen oxides as nitrogen dioxide</th>\n",
       "      <th>status.2</th>\n",
       "      <th>unit.2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>01:00</td>\n",
       "      <td>0.25166</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.75500</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>5.14087</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>02:00</td>\n",
       "      <td>0.12583</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>6.87575</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>7.06869</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>03:00</td>\n",
       "      <td>0.28312</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>5.78313</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>6.21723</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>04:00</td>\n",
       "      <td>0.22020</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>3.75899</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.09663</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>05:00</td>\n",
       "      <td>0.18874</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>3.27707</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>3.56647</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>20:00</td>\n",
       "      <td>0.28836</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>12.08703</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>12.52918</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>21:00</td>\n",
       "      <td>0.18023</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>8.29340</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>8.56974</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>22:00</td>\n",
       "      <td>0.10814</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>5.52928</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>5.69508</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>23:00</td>\n",
       "      <td>0.07209</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.77096</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.88150</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>24:00</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.17640</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.17640</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows × 11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Date   time  Nitric oxide status   unit  Nitrogen dioxide  \\\n",
       "0     01-01-2018  01:00       0.25166      R  ugm-3           4.75500   \n",
       "1     01-01-2018  02:00       0.12583      R  ugm-3           6.87575   \n",
       "2     01-01-2018  03:00       0.28312      R  ugm-3           5.78313   \n",
       "3     01-01-2018  04:00       0.22020      R  ugm-3           3.75899   \n",
       "4     01-01-2018  05:00       0.18874      R  ugm-3           3.27707   \n",
       "...          ...    ...           ...    ...    ...               ...   \n",
       "8755  31-12-2018  20:00       0.28836      R  ugm-3          12.08703   \n",
       "8756  31-12-2018  21:00       0.18023      R  ugm-3           8.29340   \n",
       "8757  31-12-2018  22:00       0.10814      R  ugm-3           5.52928   \n",
       "8758  31-12-2018  23:00       0.07209      R  ugm-3           4.77096   \n",
       "8759  31-12-2018  24:00       0.00000      R  ugm-3           4.17640   \n",
       "\n",
       "     status.1 unit.1  Nitrogen oxides as nitrogen dioxide status.2 unit.2  \n",
       "0           R  ugm-3                              5.14087        R  ugm-3  \n",
       "1           R  ugm-3                              7.06869        R  ugm-3  \n",
       "2           R  ugm-3                              6.21723        R  ugm-3  \n",
       "3           R  ugm-3                              4.09663        R  ugm-3  \n",
       "4           R  ugm-3                              3.56647        R  ugm-3  \n",
       "...       ...    ...                                  ...      ...    ...  \n",
       "8755        R  ugm-3                             12.52918        R  ugm-3  \n",
       "8756        R  ugm-3                              8.56974        R  ugm-3  \n",
       "8757        R  ugm-3                              5.69508        R  ugm-3  \n",
       "8758        R  ugm-3                              4.88150        R  ugm-3  \n",
       "8759        R  ugm-3                              4.17640        R  ugm-3  \n",
       "\n",
       "[8760 rows x 11 columns]"
      ]
     },
     "execution_count": 4,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "obsaq.read_sites('BDMP', 'aurn', year=2018)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Read data by a point of longitude and latitude\n",
    "\n",
    "Users can give a point of longitude and latitude to read the station data."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Load the obsaq package and Define the point"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 5,
   "metadata": {},
   "outputs": [],
   "source": [
    "import obsaq\n",
    "\n",
    "lon = 0.0\n",
    "lat = 55.0\n",
    "point = [lon, lat]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Get the station metadata\n",
    "\n",
    "NOTE: This is the all station information and the next step will choose the stations by point."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 6,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>site_id</th>\n",
       "      <th>site_name</th>\n",
       "      <th>location_type</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>parameter</th>\n",
       "      <th>Parameter_name</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>ratified_to</th>\n",
       "      <th>zone</th>\n",
       "      <th>agglomeration</th>\n",
       "      <th>local_authority</th>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>rownames</th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "      <th></th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>O3</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>2003-08-01</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NO</td>\n",
       "      <td>Nitric oxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NO2</td>\n",
       "      <td>Nitrogen dioxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NOXasNO2</td>\n",
       "      <td>Nitrogen oxides as nitrogen dioxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>5</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>SO2</td>\n",
       "      <td>Sulphur dioxide</td>\n",
       "      <td>2001-01-01</td>\n",
       "      <td>2007-09-30</td>\n",
       "      <td>2007-09-30</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "         site_id site_name     location_type  latitude  longitude parameter  \\\n",
       "rownames                                                                      \n",
       "1            ABD  Aberdeen  Urban Background  57.15736  -2.094278        O3   \n",
       "2            ABD  Aberdeen  Urban Background  57.15736  -2.094278        NO   \n",
       "3            ABD  Aberdeen  Urban Background  57.15736  -2.094278       NO2   \n",
       "4            ABD  Aberdeen  Urban Background  57.15736  -2.094278  NOXasNO2   \n",
       "5            ABD  Aberdeen  Urban Background  57.15736  -2.094278       SO2   \n",
       "\n",
       "                               Parameter_name  start_date    end_date  \\\n",
       "rownames                                                                \n",
       "1                                       Ozone  2003-08-01  2021-09-20   \n",
       "2                                Nitric oxide  1999-09-18  2021-09-20   \n",
       "3                            Nitrogen dioxide  1999-09-18  2021-09-20   \n",
       "4         Nitrogen oxides as nitrogen dioxide  1999-09-18  2021-09-20   \n",
       "5                             Sulphur dioxide  2001-01-01  2007-09-30   \n",
       "\n",
       "         ratified_to                 zone agglomeration local_authority  \n",
       "rownames                                                                 \n",
       "1         2021-09-20  North East Scotland           NaN   Aberdeen City  \n",
       "2         2021-09-20  North East Scotland           NaN   Aberdeen City  \n",
       "3         2021-09-20  North East Scotland           NaN   Aberdeen City  \n",
       "4         2021-09-20  North East Scotland           NaN   Aberdeen City  \n",
       "5         2007-09-30  North East Scotland           NaN   Aberdeen City  "
      ]
     },
     "execution_count": 6,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "meta = obsaq.meta()\n",
    "site_table = meta.get_metadata('aurn')\n",
    "\n",
    "site_table.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Choose the stations by point"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 7,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Site is selected by point: [0.0, 55.0]\n"
     ]
    },
    {
     "data": {
      "text/plain": [
       "site_id                                HM\n",
       "site_name                    High Muffles\n",
       "location_type            Rural Background\n",
       "latitude                        54.334497\n",
       "longitude                        -0.80882\n",
       "parameter                              O3\n",
       "Parameter_name                      Ozone\n",
       "start_date                     1987-07-16\n",
       "end_date                          ongoing\n",
       "ratified_to                    2023-12-31\n",
       "zone               Yorkshire & Humberside\n",
       "agglomeration                         NaN\n",
       "local_authority                   Ryedale\n",
       "Name: 1200, dtype: object"
      ]
     },
     "execution_count": 7,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_sites = meta.get_site(point=point)\n",
    "final_sites"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Read the station data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 8,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "https://uk-air.defra.gov.uk/data_files/site_data/HM_2018.csv\n"
     ]
    },
    {
     "data": {
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>time</th>\n",
       "      <th>Nitric oxide</th>\n",
       "      <th>status</th>\n",
       "      <th>unit</th>\n",
       "      <th>Nitrogen dioxide</th>\n",
       "      <th>status.1</th>\n",
       "      <th>unit.1</th>\n",
       "      <th>Nitrogen oxides as nitrogen dioxide</th>\n",
       "      <th>status.2</th>\n",
       "      <th>unit.2</th>\n",
       "      <th>Ozone</th>\n",
       "      <th>status.3</th>\n",
       "      <th>unit.3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>01:00</td>\n",
       "      <td>0.36708</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.00358</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.56642</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>65.32591</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>02:00</td>\n",
       "      <td>0.28550</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.06600</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.50376</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>65.85810</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>03:00</td>\n",
       "      <td>0.27531</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.22261</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.64474</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>67.15531</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>04:00</td>\n",
       "      <td>0.24472</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.26951</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.64474</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>66.40692</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>05:00</td>\n",
       "      <td>0.30590</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>2.16255</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>2.63159</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>66.20735</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>20:00</td>\n",
       "      <td>0.30417</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.38387</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.85025</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>70.34843</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>21:00</td>\n",
       "      <td>0.23657</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.27605</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.63879</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>70.39832</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>22:00</td>\n",
       "      <td>0.33796</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.17346</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.69166</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>69.89939</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>23:00</td>\n",
       "      <td>0.50694</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.44300</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>2.22030</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>68.85165</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>24:00</td>\n",
       "      <td>0.40556</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.70419</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>2.32603</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>67.85380</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows × 14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Date   time  Nitric oxide status   unit  Nitrogen dioxide  \\\n",
       "0     01-01-2018  01:00       0.36708      R  ugm-3           1.00358   \n",
       "1     01-01-2018  02:00       0.28550      R  ugm-3           1.06600   \n",
       "2     01-01-2018  03:00       0.27531      R  ugm-3           1.22261   \n",
       "3     01-01-2018  04:00       0.24472      R  ugm-3           1.26951   \n",
       "4     01-01-2018  05:00       0.30590      R  ugm-3           2.16255   \n",
       "...          ...    ...           ...    ...    ...               ...   \n",
       "8755  31-12-2018  20:00       0.30417      R  ugm-3           1.38387   \n",
       "8756  31-12-2018  21:00       0.23657      R  ugm-3           1.27605   \n",
       "8757  31-12-2018  22:00       0.33796      R  ugm-3           1.17346   \n",
       "8758  31-12-2018  23:00       0.50694      R  ugm-3           1.44300   \n",
       "8759  31-12-2018  24:00       0.40556      R  ugm-3           1.70419   \n",
       "\n",
       "     status.1 unit.1  Nitrogen oxides as nitrogen dioxide status.2 unit.2  \\\n",
       "0           R  ugm-3                              1.56642        R  ugm-3   \n",
       "1           R  ugm-3                              1.50376        R  ugm-3   \n",
       "2           R  ugm-3                              1.64474        R  ugm-3   \n",
       "3           R  ugm-3                              1.64474        R  ugm-3   \n",
       "4           R  ugm-3                              2.63159        R  ugm-3   \n",
       "...       ...    ...                                  ...      ...    ...   \n",
       "8755        R  ugm-3                              1.85025        R  ugm-3   \n",
       "8756        R  ugm-3                              1.63879        R  ugm-3   \n",
       "8757        R  ugm-3                              1.69166        R  ugm-3   \n",
       "8758        R  ugm-3                              2.22030        R  ugm-3   \n",
       "8759        R  ugm-3                              2.32603        R  ugm-3   \n",
       "\n",
       "         Ozone status.3 unit.3  \n",
       "0     65.32591        R  ugm-3  \n",
       "1     65.85810        R  ugm-3  \n",
       "2     67.15531        R  ugm-3  \n",
       "3     66.40692        R  ugm-3  \n",
       "4     66.20735        R  ugm-3  \n",
       "...        ...      ...    ...  \n",
       "8755  70.34843        R  ugm-3  \n",
       "8756  70.39832        R  ugm-3  \n",
       "8757  69.89939        R  ugm-3  \n",
       "8758  68.85165        R  ugm-3  \n",
       "8759  67.85380        R  ugm-3  \n",
       "\n",
       "[8760 rows x 14 columns]"
      ]
     },
     "execution_count": 8,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "obsaq.read_sites('HM', 'aurn', year=2018)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "py38",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.12.3"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}

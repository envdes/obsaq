{
 "cells": [
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "# Obtain the data from AURN\n",
    "\n"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Download data by a bounds of longitude and latitude\n",
    "\n",
    "Users can give a bounds of longitude and latitude to download the station data."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Load the ObsAQ package and Define the range"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import obsaq\n",
    "\n",
    "lon_min = -9\n",
    "lon_max = 1.8\n",
    "lat_min = 49\n",
    "lat_max = 61\n",
    "bounds=[lon_min, lon_max, lat_min, lat_max]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Get the station metadata\n",
    "\n",
    "NOTE: This is the all station information and the next step will choose the stations by bounds."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "meta = obsaq.meta()\n",
    "site_table = meta.get_metadata('aurn')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Choose the stations by range"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 3,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Site is selected by bounds: [-9, 1.8, 49, 61]\n"
     ]
    },
    {
     "data": {
      "application/vnd.microsoft.datawrangler.viewer.v0+json": {
       "columns": [
        {
         "name": "index",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "site_id",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "site_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "location_type",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "latitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "longitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "parameter",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "Parameter_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "start_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "end_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "ratified_to",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "zone",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "agglomeration",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "local_authority",
         "rawType": "object",
         "type": "string"
        }
       ],
       "ref": "82a34d02-da67-4f0b-9e88-72e9a1e5cba4",
       "rows": [
        [
         "0",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "O3",
         "Ozone",
         "2003-08-01",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "1",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "NO",
         "Nitric oxide",
         "1999-09-18",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "2",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "NO2",
         "Nitrogen dioxide",
         "1999-09-18",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "3",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "NOXasNO2",
         "Nitrogen oxides as nitrogen dioxide",
         "1999-09-18",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "4",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "SO2",
         "Sulphur dioxide",
         "2001-01-01",
         "2007-09-30",
         "2007-09-30",
         "North East Scotland",
         null,
         "Aberdeen City"
        ]
       ],
       "shape": {
        "columns": 13,
        "rows": 5
       }
      },
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>site_id</th>\n",
       "      <th>site_name</th>\n",
       "      <th>location_type</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>parameter</th>\n",
       "      <th>Parameter_name</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>ratified_to</th>\n",
       "      <th>zone</th>\n",
       "      <th>agglomeration</th>\n",
       "      <th>local_authority</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>O3</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>2003-08-01</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NO</td>\n",
       "      <td>Nitric oxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NO2</td>\n",
       "      <td>Nitrogen dioxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NOXasNO2</td>\n",
       "      <td>Nitrogen oxides as nitrogen dioxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>SO2</td>\n",
       "      <td>Sulphur dioxide</td>\n",
       "      <td>2001-01-01</td>\n",
       "      <td>2007-09-30</td>\n",
       "      <td>2007-09-30</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  site_id site_name     location_type  latitude  longitude parameter  \\\n",
       "0     ABD  Aberdeen  Urban Background  57.15736  -2.094278        O3   \n",
       "1     ABD  Aberdeen  Urban Background  57.15736  -2.094278        NO   \n",
       "2     ABD  Aberdeen  Urban Background  57.15736  -2.094278       NO2   \n",
       "3     ABD  Aberdeen  Urban Background  57.15736  -2.094278  NOXasNO2   \n",
       "4     ABD  Aberdeen  Urban Background  57.15736  -2.094278       SO2   \n",
       "\n",
       "                        Parameter_name  start_date    end_date ratified_to  \\\n",
       "0                                Ozone  2003-08-01  2021-09-20  2021-09-20   \n",
       "1                         Nitric oxide  1999-09-18  2021-09-20  2021-09-20   \n",
       "2                     Nitrogen dioxide  1999-09-18  2021-09-20  2021-09-20   \n",
       "3  Nitrogen oxides as nitrogen dioxide  1999-09-18  2021-09-20  2021-09-20   \n",
       "4                      Sulphur dioxide  2001-01-01  2007-09-30  2007-09-30   \n",
       "\n",
       "                  zone agglomeration local_authority  \n",
       "0  North East Scotland           NaN   Aberdeen City  \n",
       "1  North East Scotland           NaN   Aberdeen City  \n",
       "2  North East Scotland           NaN   Aberdeen City  \n",
       "3  North East Scotland           NaN   Aberdeen City  \n",
       "4  North East Scotland           NaN   Aberdeen City  "
      ]
     },
     "execution_count": 3,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_sites = meta.get_site(bounds=bounds)\n",
    "final_sites.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Start to download the selected station data\n",
    "- `pollutant`: See names of pollutants. Define one pollutant, diverse pollutants or all pollutants to download the data for them.\n",
    "               Pollutants can be defined as \"PM2.5\",\"PM10\",\"O3\",\"NO\",\"NO2\",\"NOXasNO2\" or \"SO2\".\n",
    "- `start`: the start date of data to be downloaded.\n",
    "- `end`: the end date of data to be downloaded.\n",
    "- `year`: the year of data to be downloaded. Defaults to 2010.\n",
    "- `output_dir`: the directory to save the downloaded data. \n",
    "- `download_mode`: \"Stream\" for saving final and intermediate files while \"memory\" for only the final file.\n",
    "- `save_per_site`: whether save files for every station individually.\n",
    "- `save_merged`: whether save the merged file for all selected data.\n",
    "- `add_site_id`: whether include site id in the downloaded file.\n",
    "\n",
    "Download data for every station. \n",
    "Decide whether to download the final merged data for all targeted stations by choosing \"save_merged=True/False\".\n",
    "\n",
    "Warnings are normal for merging data with different format. Ingoring them can be fine. "
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 4,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "     site_id        site_name     location_type   latitude  longitude  \\\n",
      "0        ABD         Aberdeen  Urban Background  57.157360  -2.094278   \n",
      "1        ABD         Aberdeen  Urban Background  57.157360  -2.094278   \n",
      "2        ABD         Aberdeen  Urban Background  57.157360  -2.094278   \n",
      "3        ABD         Aberdeen  Urban Background  57.157360  -2.094278   \n",
      "6        ABD         Aberdeen  Urban Background  57.157360  -2.094278   \n",
      "...      ...              ...               ...        ...        ...   \n",
      "3057    YK11  York Fishergate     Urban Traffic  53.951889  -1.075861   \n",
      "3058    YK11  York Fishergate     Urban Traffic  53.951889  -1.075861   \n",
      "3059    YK11  York Fishergate     Urban Traffic  53.951889  -1.075861   \n",
      "3060    YK11  York Fishergate     Urban Traffic  53.951889  -1.075861   \n",
      "3061    YK11  York Fishergate     Urban Traffic  53.951889  -1.075861   \n",
      "\n",
      "     parameter                             Parameter_name  start_date  \\\n",
      "0           O3                                      Ozone  2003-08-01   \n",
      "1           NO                               Nitric oxide  1999-09-18   \n",
      "2          NO2                           Nitrogen dioxide  1999-09-18   \n",
      "3     NOXasNO2        Nitrogen oxides as nitrogen dioxide  1999-09-18   \n",
      "6         PM10  PM10 particulate matter (Hourly measured)  1999-09-18   \n",
      "...        ...                                        ...         ...   \n",
      "3057     NV2.5       Non-volatile PM2.5 (Hourly measured)  2011-08-31   \n",
      "3058      V2.5           Volatile PM2.5 (Hourly measured)  2011-08-31   \n",
      "3059        wd                    Modelled Wind Direction  2010-08-01   \n",
      "3060        ws                        Modelled Wind Speed  2010-08-01   \n",
      "3061      temp                       Modelled Temperature  2010-08-01   \n",
      "\n",
      "        end_date ratified_to                    zone agglomeration  \\\n",
      "0     2021-09-20  2021-09-20     North East Scotland           NaN   \n",
      "1     2021-09-20  2021-09-20     North East Scotland           NaN   \n",
      "2     2021-09-20  2021-09-20     North East Scotland           NaN   \n",
      "3     2021-09-20  2021-09-20     North East Scotland           NaN   \n",
      "6     2021-09-20  2021-09-20     North East Scotland           NaN   \n",
      "...          ...         ...                     ...           ...   \n",
      "3057  2018-10-10  2018-10-10  Yorkshire & Humberside           NaN   \n",
      "3058  2018-10-10  2018-10-10  Yorkshire & Humberside           NaN   \n",
      "3059     ongoing       Never  Yorkshire & Humberside           NaN   \n",
      "3060     ongoing       Never  Yorkshire & Humberside           NaN   \n",
      "3061     ongoing       Never  Yorkshire & Humberside           NaN   \n",
      "\n",
      "     local_authority  \n",
      "0      Aberdeen City  \n",
      "1      Aberdeen City  \n",
      "2      Aberdeen City  \n",
      "3      Aberdeen City  \n",
      "6      Aberdeen City  \n",
      "...              ...  \n",
      "3057            York  \n",
      "3058            York  \n",
      "3059            York  \n",
      "3060            York  \n",
      "3061            York  \n",
      "\n",
      "[1625 rows x 13 columns]\n",
      "Saved per-site file: data/test_pm25/ABD_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/ACTH_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/AGRN_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/BEL2_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/BEX_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/BIRR_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/BLC2_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/BMLD_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/BORN_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/BPLE_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/BRS8_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/CA1_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/CARD_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/CARL_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/CHAT_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/CHBO_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/CHBR_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/CHLG_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/CHP_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/CHS7_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/CLL2_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/COAL_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/DERR_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/EAGL_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/EB_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/ECCL_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/ED3_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/GHSR_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/GKA8_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/GLKP_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/GRAN_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/HOPE_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/HORS_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/HRL_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/HUL2_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/INV2_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/KC1_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/LEAM_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/LEAR_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/LECU_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/LED6_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/LEED_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/LN_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/LON6_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/LVP_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/MAN3_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/MID_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/MY1_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/NEWC_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/NO12_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/NOTT_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/NPT3_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/NTN4_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/OX8_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/PEMB_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/PLYM_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/PMTH_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/PRES_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/PT4_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/REA1_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/ROCH_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/SASH_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/SDY_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/SEND_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/SHBR_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/SHDG_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/SOTR_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/SOUT_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/STOK_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/STOR_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/SUN2_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/SWA1_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/TED2_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/TRAN_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/WAR_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/WIG5_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/WREX_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/WTHG_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/YK10_PM2.5_20171201_20181130.csv\n",
      "Saved per-site file: data/test_pm25/YK11_PM2.5_20171201_20181130.csv\n",
      "Saved merged file: data/test_pm25/MERGED_aurn_PM2.5_20171201_20181130.csv\n"
     ]
    }
   ],
   "source": [
    "merged_df = meta.download_sites(\n",
    "    port=\"aurn\",\n",
    "    pollutant=\"PM2.5\",\n",
    "    start=\"2017-12-01\",\n",
    "    end=\"2018-11-30\",\n",
    "    output_dir=\"data/test_pm25\",\n",
    "    download_mode=\"stream\",     \n",
    "    save_per_site=True,\n",
    "    save_merged=True,\n",
    "    add_site_id=True\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Download data by site_id"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Load the ObsAQ package and check the site information"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.microsoft.datawrangler.viewer.v0+json": {
       "columns": [
        {
         "name": "index",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "site_id",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "site_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "location_type",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "latitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "longitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "parameter",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "Parameter_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "start_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "end_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "ratified_to",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "zone",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "agglomeration",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "local_authority",
         "rawType": "object",
         "type": "string"
        }
       ],
       "ref": "198b97af-e026-4f4c-a37d-f352b519124a",
       "rows": [
        [
         "0",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "O3",
         "Ozone",
         "2003-08-01",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "1",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "NO",
         "Nitric oxide",
         "1999-09-18",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "2",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "NO2",
         "Nitrogen dioxide",
         "1999-09-18",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "3",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "NOXasNO2",
         "Nitrogen oxides as nitrogen dioxide",
         "1999-09-18",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "4",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "SO2",
         "Sulphur dioxide",
         "2001-01-01",
         "2007-09-30",
         "2007-09-30",
         "North East Scotland",
         null,
         "Aberdeen City"
        ]
       ],
       "shape": {
        "columns": 13,
        "rows": 5
       }
      },
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>site_id</th>\n",
       "      <th>site_name</th>\n",
       "      <th>location_type</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>parameter</th>\n",
       "      <th>Parameter_name</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>ratified_to</th>\n",
       "      <th>zone</th>\n",
       "      <th>agglomeration</th>\n",
       "      <th>local_authority</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>O3</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>2003-08-01</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NO</td>\n",
       "      <td>Nitric oxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NO2</td>\n",
       "      <td>Nitrogen dioxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NOXasNO2</td>\n",
       "      <td>Nitrogen oxides as nitrogen dioxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>SO2</td>\n",
       "      <td>Sulphur dioxide</td>\n",
       "      <td>2001-01-01</td>\n",
       "      <td>2007-09-30</td>\n",
       "      <td>2007-09-30</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  site_id site_name     location_type  latitude  longitude parameter  \\\n",
       "0     ABD  Aberdeen  Urban Background  57.15736  -2.094278        O3   \n",
       "1     ABD  Aberdeen  Urban Background  57.15736  -2.094278        NO   \n",
       "2     ABD  Aberdeen  Urban Background  57.15736  -2.094278       NO2   \n",
       "3     ABD  Aberdeen  Urban Background  57.15736  -2.094278  NOXasNO2   \n",
       "4     ABD  Aberdeen  Urban Background  57.15736  -2.094278       SO2   \n",
       "\n",
       "                        Parameter_name  start_date    end_date ratified_to  \\\n",
       "0                                Ozone  2003-08-01  2021-09-20  2021-09-20   \n",
       "1                         Nitric oxide  1999-09-18  2021-09-20  2021-09-20   \n",
       "2                     Nitrogen dioxide  1999-09-18  2021-09-20  2021-09-20   \n",
       "3  Nitrogen oxides as nitrogen dioxide  1999-09-18  2021-09-20  2021-09-20   \n",
       "4                      Sulphur dioxide  2001-01-01  2007-09-30  2007-09-30   \n",
       "\n",
       "                  zone agglomeration local_authority  \n",
       "0  North East Scotland           NaN   Aberdeen City  \n",
       "1  North East Scotland           NaN   Aberdeen City  \n",
       "2  North East Scotland           NaN   Aberdeen City  \n",
       "3  North East Scotland           NaN   Aberdeen City  \n",
       "4  North East Scotland           NaN   Aberdeen City  "
      ]
     },
     "execution_count": 9,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "import obsaq\n",
    "\n",
    "meta = obsaq.meta()\n",
    "site_table = meta.get_metadata('aurn')\n",
    "\n",
    "site_table.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Choose the stations by site_id"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 10,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Site is selected by site_id: ABD\n"
     ]
    },
    {
     "data": {
      "application/vnd.microsoft.datawrangler.viewer.v0+json": {
       "columns": [
        {
         "name": "index",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "site_id",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "site_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "location_type",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "latitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "longitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "parameter",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "Parameter_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "start_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "end_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "ratified_to",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "zone",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "agglomeration",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "local_authority",
         "rawType": "object",
         "type": "string"
        }
       ],
       "ref": "841dcd1a-a964-4ce4-9dd6-d3dcaa036ac9",
       "rows": [
        [
         "0",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "O3",
         "Ozone",
         "2003-08-01",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ]
       ],
       "shape": {
        "columns": 13,
        "rows": 1
       }
      },
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>site_id</th>\n",
       "      <th>site_name</th>\n",
       "      <th>location_type</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>parameter</th>\n",
       "      <th>Parameter_name</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>ratified_to</th>\n",
       "      <th>zone</th>\n",
       "      <th>agglomeration</th>\n",
       "      <th>local_authority</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>O3</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>2003-08-01</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  site_id site_name     location_type  latitude  longitude parameter  \\\n",
       "0     ABD  Aberdeen  Urban Background  57.15736  -2.094278        O3   \n",
       "\n",
       "  Parameter_name  start_date    end_date ratified_to                 zone  \\\n",
       "0          Ozone  2003-08-01  2021-09-20  2021-09-20  North East Scotland   \n",
       "\n",
       "  agglomeration local_authority  \n",
       "0           NaN   Aberdeen City  "
      ]
     },
     "execution_count": 10,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_sites = meta.get_site(site_id='ABD')\n",
    "final_sites.drop_duplicates(subset='site_id')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Start to download the selected station data\n",
    "- Use \"start\" and \"end\" to define a period of time.\n",
    "- Other parameters are the same as \"Download data by a bounds of longitude and latitude\" part"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 11,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "   site_id site_name     location_type  latitude  longitude parameter  \\\n",
      "0      ABD  Aberdeen  Urban Background  57.15736  -2.094278        O3   \n",
      "1      ABD  Aberdeen  Urban Background  57.15736  -2.094278        NO   \n",
      "2      ABD  Aberdeen  Urban Background  57.15736  -2.094278       NO2   \n",
      "3      ABD  Aberdeen  Urban Background  57.15736  -2.094278  NOXasNO2   \n",
      "6      ABD  Aberdeen  Urban Background  57.15736  -2.094278      PM10   \n",
      "7      ABD  Aberdeen  Urban Background  57.15736  -2.094278      NV10   \n",
      "8      ABD  Aberdeen  Urban Background  57.15736  -2.094278       V10   \n",
      "9      ABD  Aberdeen  Urban Background  57.15736  -2.094278     PM2.5   \n",
      "10     ABD  Aberdeen  Urban Background  57.15736  -2.094278     NV2.5   \n",
      "11     ABD  Aberdeen  Urban Background  57.15736  -2.094278      V2.5   \n",
      "12     ABD  Aberdeen  Urban Background  57.15736  -2.094278        wd   \n",
      "13     ABD  Aberdeen  Urban Background  57.15736  -2.094278        ws   \n",
      "14     ABD  Aberdeen  Urban Background  57.15736  -2.094278      temp   \n",
      "\n",
      "                                Parameter_name  start_date    end_date  \\\n",
      "0                                        Ozone  2003-08-01  2021-09-20   \n",
      "1                                 Nitric oxide  1999-09-18  2021-09-20   \n",
      "2                             Nitrogen dioxide  1999-09-18  2021-09-20   \n",
      "3          Nitrogen oxides as nitrogen dioxide  1999-09-18  2021-09-20   \n",
      "6    PM10 particulate matter (Hourly measured)  1999-09-18  2021-09-20   \n",
      "7          Non-volatile PM10 (Hourly measured)  2009-02-20  2019-11-07   \n",
      "8              Volatile PM10 (Hourly measured)  2009-02-20  2019-11-07   \n",
      "9   PM2.5 particulate matter (Hourly measured)  2009-02-20  2021-09-20   \n",
      "10        Non-volatile PM2.5 (Hourly measured)  2009-02-20  2019-11-07   \n",
      "11            Volatile PM2.5 (Hourly measured)  2009-02-20  2019-11-07   \n",
      "12                     Modelled Wind Direction  2010-08-01  2021-09-20   \n",
      "13                         Modelled Wind Speed  2010-08-01  2021-09-20   \n",
      "14                        Modelled Temperature  2010-08-01  2021-09-20   \n",
      "\n",
      "   ratified_to                 zone agglomeration local_authority  \n",
      "0   2021-09-20  North East Scotland           NaN   Aberdeen City  \n",
      "1   2021-09-20  North East Scotland           NaN   Aberdeen City  \n",
      "2   2021-09-20  North East Scotland           NaN   Aberdeen City  \n",
      "3   2021-09-20  North East Scotland           NaN   Aberdeen City  \n",
      "6   2021-09-20  North East Scotland           NaN   Aberdeen City  \n",
      "7   2019-11-07  North East Scotland           NaN   Aberdeen City  \n",
      "8   2019-11-07  North East Scotland           NaN   Aberdeen City  \n",
      "9   2021-09-20  North East Scotland           NaN   Aberdeen City  \n",
      "10  2019-11-07  North East Scotland           NaN   Aberdeen City  \n",
      "11  2019-11-07  North East Scotland           NaN   Aberdeen City  \n",
      "12       Never  North East Scotland           NaN   Aberdeen City  \n",
      "13       Never  North East Scotland           NaN   Aberdeen City  \n",
      "14       Never  North East Scotland           NaN   Aberdeen City  \n",
      "Saved per-site file: data/test_pm25_siteid/ABD_PM2.5_20171201_20181130.csv\n"
     ]
    }
   ],
   "source": [
    "meta.download_sites(\n",
    "    port=\"aurn\",\n",
    "    pollutant=\"PM2.5\",\n",
    "    start=\"2017-12-01\",\n",
    "    end=\"2018-11-30\",\n",
    "    output_dir=\"data/test_pm25_siteid\",\n",
    "    download_mode=\"stream\",     \n",
    "    save_per_site=True,\n",
    "    save_merged=False,\n",
    "    add_site_id=True\n",
    ")"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "## Read the data from AURN"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Read the site data by a bounds of longitude and latitude\n",
    "\n",
    "Users can give a bounds of longitude and latitude to read the site data."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Load the ObsAQ package and Define the range"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import obsaq\n",
    "\n",
    "lon_min = -1\n",
    "lon_max = 2\n",
    "lat_min = 50\n",
    "lat_max = 55\n",
    "bounds=[lon_min, lon_max, lat_min, lat_max]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Get the station metadata\n",
    "\n",
    "NOTE: This is the all station information and the next step will choose the stations by bounds."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "meta = obsaq.meta()\n",
    "site_table = meta.get_metadata('aurn')"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Choose the stations by range"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 14,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Site is selected by bounds: [-1, 2, 50, 55]\n"
     ]
    },
    {
     "data": {
      "application/vnd.microsoft.datawrangler.viewer.v0+json": {
       "columns": [
        {
         "name": "index",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "site_id",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "site_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "location_type",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "latitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "longitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "parameter",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "Parameter_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "start_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "end_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "ratified_to",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "zone",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "agglomeration",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "local_authority",
         "rawType": "object",
         "type": "string"
        }
       ],
       "ref": "a5b99ffd-4f3b-493e-8b09-875e76912d46",
       "rows": [
        [
         "93",
         "AYLA",
         "Aylesbury A4157",
         "Urban Traffic",
         "51.822161",
         "-0.793884",
         "PM2.5",
         "PM2.5 particulate matter (Hourly measured)",
         "2025-08-11",
         "ongoing",
         "2025-09-30",
         "South East",
         null,
         "Aylesbury Vale"
        ],
        [
         "94",
         "AYLA",
         "Aylesbury A4157",
         "Urban Traffic",
         "51.822161",
         "-0.793884",
         "wd",
         "Modelled Wind Direction",
         "2025-08-11",
         "ongoing",
         "Never",
         "South East",
         null,
         "Aylesbury Vale"
        ],
        [
         "95",
         "AYLA",
         "Aylesbury A4157",
         "Urban Traffic",
         "51.822161",
         "-0.793884",
         "ws",
         "Modelled Wind Speed",
         "2025-08-11",
         "ongoing",
         "Never",
         "South East",
         null,
         "Aylesbury Vale"
        ],
        [
         "96",
         "AYLA",
         "Aylesbury A4157",
         "Urban Traffic",
         "51.822161",
         "-0.793884",
         "temp",
         "Modelled Temperature",
         "2025-08-11",
         "ongoing",
         "Never",
         "South East",
         null,
         "Aylesbury Vale"
        ],
        [
         "386",
         "BDMP",
         "Borehamwood Meadow Park",
         "Urban Background",
         "51.661229",
         "-0.27055",
         "NO",
         "Nitric oxide",
         "2017-10-01",
         "ongoing",
         "2025-09-30",
         "Eastern",
         null,
         "Hertsmere"
        ]
       ],
       "shape": {
        "columns": 13,
        "rows": 5
       }
      },
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>site_id</th>\n",
       "      <th>site_name</th>\n",
       "      <th>location_type</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>parameter</th>\n",
       "      <th>Parameter_name</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>ratified_to</th>\n",
       "      <th>zone</th>\n",
       "      <th>agglomeration</th>\n",
       "      <th>local_authority</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>93</th>\n",
       "      <td>AYLA</td>\n",
       "      <td>Aylesbury A4157</td>\n",
       "      <td>Urban Traffic</td>\n",
       "      <td>51.822161</td>\n",
       "      <td>-0.793884</td>\n",
       "      <td>PM2.5</td>\n",
       "      <td>PM2.5 particulate matter (Hourly measured)</td>\n",
       "      <td>2025-08-11</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>2025-09-30</td>\n",
       "      <td>South East</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aylesbury Vale</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>94</th>\n",
       "      <td>AYLA</td>\n",
       "      <td>Aylesbury A4157</td>\n",
       "      <td>Urban Traffic</td>\n",
       "      <td>51.822161</td>\n",
       "      <td>-0.793884</td>\n",
       "      <td>wd</td>\n",
       "      <td>Modelled Wind Direction</td>\n",
       "      <td>2025-08-11</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>Never</td>\n",
       "      <td>South East</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aylesbury Vale</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>95</th>\n",
       "      <td>AYLA</td>\n",
       "      <td>Aylesbury A4157</td>\n",
       "      <td>Urban Traffic</td>\n",
       "      <td>51.822161</td>\n",
       "      <td>-0.793884</td>\n",
       "      <td>ws</td>\n",
       "      <td>Modelled Wind Speed</td>\n",
       "      <td>2025-08-11</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>Never</td>\n",
       "      <td>South East</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aylesbury Vale</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>96</th>\n",
       "      <td>AYLA</td>\n",
       "      <td>Aylesbury A4157</td>\n",
       "      <td>Urban Traffic</td>\n",
       "      <td>51.822161</td>\n",
       "      <td>-0.793884</td>\n",
       "      <td>temp</td>\n",
       "      <td>Modelled Temperature</td>\n",
       "      <td>2025-08-11</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>Never</td>\n",
       "      <td>South East</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aylesbury Vale</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>386</th>\n",
       "      <td>BDMP</td>\n",
       "      <td>Borehamwood Meadow Park</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>51.661229</td>\n",
       "      <td>-0.270550</td>\n",
       "      <td>NO</td>\n",
       "      <td>Nitric oxide</td>\n",
       "      <td>2017-10-01</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>2025-09-30</td>\n",
       "      <td>Eastern</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Hertsmere</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "    site_id                site_name     location_type   latitude  longitude  \\\n",
       "93     AYLA          Aylesbury A4157     Urban Traffic  51.822161  -0.793884   \n",
       "94     AYLA          Aylesbury A4157     Urban Traffic  51.822161  -0.793884   \n",
       "95     AYLA          Aylesbury A4157     Urban Traffic  51.822161  -0.793884   \n",
       "96     AYLA          Aylesbury A4157     Urban Traffic  51.822161  -0.793884   \n",
       "386    BDMP  Borehamwood Meadow Park  Urban Background  51.661229  -0.270550   \n",
       "\n",
       "    parameter                              Parameter_name  start_date  \\\n",
       "93      PM2.5  PM2.5 particulate matter (Hourly measured)  2025-08-11   \n",
       "94         wd                     Modelled Wind Direction  2025-08-11   \n",
       "95         ws                         Modelled Wind Speed  2025-08-11   \n",
       "96       temp                        Modelled Temperature  2025-08-11   \n",
       "386        NO                                Nitric oxide  2017-10-01   \n",
       "\n",
       "    end_date ratified_to        zone agglomeration local_authority  \n",
       "93   ongoing  2025-09-30  South East           NaN  Aylesbury Vale  \n",
       "94   ongoing       Never  South East           NaN  Aylesbury Vale  \n",
       "95   ongoing       Never  South East           NaN  Aylesbury Vale  \n",
       "96   ongoing       Never  South East           NaN  Aylesbury Vale  \n",
       "386  ongoing  2025-09-30     Eastern           NaN       Hertsmere  "
      ]
     },
     "execution_count": 14,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_sites = meta.get_site(bounds=bounds)\n",
    "final_sites.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Choose a site by `site_id` and read it directly"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.microsoft.datawrangler.viewer.v0+json": {
       "columns": [
        {
         "name": "index",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "Date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "time",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "Nitric oxide",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "status",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "unit",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "Nitrogen dioxide",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "status.1",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "unit.1",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "Nitrogen oxides as nitrogen dioxide",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "status.2",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "unit.2",
         "rawType": "object",
         "type": "unknown"
        }
       ],
       "ref": "b2b0142d-6e26-434d-9738-979e6afda55b",
       "rows": [
        [
         "0",
         "01-01-2018",
         "01:00",
         "0.25166",
         "R",
         "ugm-3",
         "4.755",
         "R",
         "ugm-3",
         "5.14087",
         "R",
         "ugm-3"
        ],
        [
         "1",
         "01-01-2018",
         "02:00",
         "0.12583",
         "R",
         "ugm-3",
         "6.87575",
         "R",
         "ugm-3",
         "7.06869",
         "R",
         "ugm-3"
        ],
        [
         "2",
         "01-01-2018",
         "03:00",
         "0.28312",
         "R",
         "ugm-3",
         "5.78313",
         "R",
         "ugm-3",
         "6.21723",
         "R",
         "ugm-3"
        ],
        [
         "3",
         "01-01-2018",
         "04:00",
         "0.2202",
         "R",
         "ugm-3",
         "3.75899",
         "R",
         "ugm-3",
         "4.09663",
         "R",
         "ugm-3"
        ],
        [
         "4",
         "01-01-2018",
         "05:00",
         "0.18874",
         "R",
         "ugm-3",
         "3.27707",
         "R",
         "ugm-3",
         "3.56647",
         "R",
         "ugm-3"
        ],
        [
         "5",
         "01-01-2018",
         "06:00",
         "0.15729",
         "R",
         "ugm-3",
         "4.09644",
         "R",
         "ugm-3",
         "4.3376",
         "R",
         "ugm-3"
        ],
        [
         "6",
         "01-01-2018",
         "07:00",
         "0.28312",
         "R",
         "ugm-3",
         "6.21689",
         "R",
         "ugm-3",
         "6.65099",
         "R",
         "ugm-3"
        ],
        [
         "7",
         "01-01-2018",
         "08:00",
         "0.40894",
         "R",
         "ugm-3",
         "15.18112",
         "R",
         "ugm-3",
         "15.80816",
         "R",
         "ugm-3"
        ],
        [
         "8",
         "01-01-2018",
         "09:00",
         "0.91226",
         "R",
         "ugm-3",
         "22.60264",
         "R",
         "ugm-3",
         "24.00141",
         "R",
         "ugm-3"
        ],
        [
         "9",
         "01-01-2018",
         "10:00",
         "1.50994",
         "R",
         "ugm-3",
         "25.10808",
         "R",
         "ugm-3",
         "27.4233",
         "R",
         "ugm-3"
        ],
        [
         "10",
         "01-01-2018",
         "11:00",
         "2.73677",
         "R",
         "ugm-3",
         "33.73361",
         "R",
         "ugm-3",
         "37.92994",
         "R",
         "ugm-3"
        ],
        [
         "11",
         "01-01-2018",
         "12:00",
         "6.606",
         "R",
         "ugm-3",
         "49.34431",
         "R",
         "ugm-3",
         "59.47337",
         "R",
         "ugm-3"
        ],
        [
         "12",
         "01-01-2018",
         "13:00",
         "2.6424",
         "R",
         "ugm-3",
         "27.56469",
         "R",
         "ugm-3",
         "31.61631",
         "R",
         "ugm-3"
        ],
        [
         "13",
         "01-01-2018",
         "14:00",
         "0.59769",
         "R",
         "ugm-3",
         "8.67449",
         "R",
         "ugm-3",
         "9.59093",
         "R",
         "ugm-3"
        ],
        [
         "14",
         "01-01-2018",
         "15:00",
         "0.47186",
         "R",
         "ugm-3",
         "6.40945",
         "R",
         "ugm-3",
         "7.13295",
         "R",
         "ugm-3"
        ],
        [
         "15",
         "01-01-2018",
         "16:00",
         "0.53477",
         "R",
         "ugm-3",
         "9.83126",
         "R",
         "ugm-3",
         "10.65123",
         "R",
         "ugm-3"
        ],
        [
         "16",
         "01-01-2018",
         "17:00",
         "0.56623",
         "R",
         "ugm-3",
         "13.97604",
         "R",
         "ugm-3",
         "14.84425",
         "R",
         "ugm-3"
        ],
        [
         "17",
         "01-01-2018",
         "18:00",
         "0.4404",
         "R",
         "ugm-3",
         "10.74709",
         "R",
         "ugm-3",
         "11.42236",
         "R",
         "ugm-3"
        ],
        [
         "18",
         "01-01-2018",
         "19:00",
         "0.37749",
         "R",
         "ugm-3",
         "8.57836",
         "R",
         "ugm-3",
         "9.15717",
         "R",
         "ugm-3"
        ],
        [
         "19",
         "01-01-2018",
         "20:00",
         "0.2202",
         "R",
         "ugm-3",
         "5.25305",
         "R",
         "ugm-3",
         "5.59069",
         "R",
         "ugm-3"
        ],
        [
         "20",
         "01-01-2018",
         "21:00",
         "0.15729",
         "R",
         "ugm-3",
         "3.85546",
         "R",
         "ugm-3",
         "4.09663",
         "R",
         "ugm-3"
        ],
        [
         "21",
         "01-01-2018",
         "22:00",
         "0.12583",
         "R",
         "ugm-3",
         "3.42174",
         "R",
         "ugm-3",
         "3.61467",
         "R",
         "ugm-3"
        ],
        [
         "22",
         "01-01-2018",
         "23:00",
         "0.12583",
         "R",
         "ugm-3",
         "3.66271",
         "R",
         "ugm-3",
         "3.85565",
         "R",
         "ugm-3"
        ],
        [
         "23",
         "01-01-2018",
         "24:00",
         "0.0",
         "R",
         "ugm-3",
         "2.55437",
         "R",
         "ugm-3",
         "2.55437",
         "R",
         "ugm-3"
        ],
        [
         "24",
         "02-01-2018",
         "01:00",
         "0.04196",
         "R",
         "ugm-3",
         "3.21455",
         "R",
         "ugm-3",
         "3.27889",
         "R",
         "ugm-3"
        ],
        [
         "25",
         "02-01-2018",
         "02:00",
         "0.0",
         "R",
         "ugm-3",
         "4.95048",
         "R",
         "ugm-3",
         "4.95048",
         "R",
         "ugm-3"
        ],
        [
         "26",
         "02-01-2018",
         "03:00",
         "0.12589",
         "R",
         "ugm-3",
         "4.38778",
         "R",
         "ugm-3",
         "4.58081",
         "R",
         "ugm-3"
        ],
        [
         "27",
         "02-01-2018",
         "04:00",
         "0.25177",
         "R",
         "ugm-3",
         "6.3164",
         "R",
         "ugm-3",
         "6.70244",
         "R",
         "ugm-3"
        ],
        [
         "28",
         "02-01-2018",
         "05:00",
         "0.28324",
         "R",
         "ugm-3",
         "7.61827",
         "R",
         "ugm-3",
         "8.05257",
         "R",
         "ugm-3"
        ],
        [
         "29",
         "02-01-2018",
         "06:00",
         "0.53501",
         "R",
         "ugm-3",
         "9.83606",
         "R",
         "ugm-3",
         "10.6564",
         "R",
         "ugm-3"
        ],
        [
         "30",
         "02-01-2018",
         "07:00",
         "1.16444",
         "R",
         "ugm-3",
         "15.91092",
         "R",
         "ugm-3",
         "17.69637",
         "R",
         "ugm-3"
        ],
        [
         "31",
         "02-01-2018",
         "08:00",
         "7.08106",
         "R",
         "ugm-3",
         "47.00533",
         "R",
         "ugm-3",
         "57.8628",
         "R",
         "ugm-3"
        ],
        [
         "32",
         "02-01-2018",
         "09:00",
         "19.26047",
         "R",
         "ugm-3",
         "65.1698",
         "R",
         "ugm-3",
         "94.70211",
         "R",
         "ugm-3"
        ],
        [
         "33",
         "02-01-2018",
         "10:00",
         "23.03703",
         "R",
         "ugm-3",
         "64.53858",
         "R",
         "ugm-3",
         "99.86154",
         "R",
         "ugm-3"
        ],
        [
         "34",
         "02-01-2018",
         "11:00",
         "24.67354",
         "R",
         "ugm-3",
         "67.47805",
         "R",
         "ugm-3",
         "105.31029",
         "R",
         "ugm-3"
        ],
        [
         "35",
         "02-01-2018",
         "12:00",
         "11.48704",
         "R",
         "ugm-3",
         "55.82431",
         "R",
         "ugm-3",
         "73.43753",
         "R",
         "ugm-3"
        ],
        [
         "36",
         "02-01-2018",
         "13:00",
         "7.30136",
         "R",
         "ugm-3",
         "46.47466",
         "R",
         "ugm-3",
         "57.66992",
         "R",
         "ugm-3"
        ],
        [
         "37",
         "02-01-2018",
         "14:00",
         "3.24155",
         "R",
         "ugm-3",
         "27.96327",
         "R",
         "ugm-3",
         "32.93358",
         "R",
         "ugm-3"
        ],
        [
         "38",
         "02-01-2018",
         "15:00",
         "2.17152",
         "R",
         "ugm-3",
         "25.98753",
         "R",
         "ugm-3",
         "29.31715",
         "R",
         "ugm-3"
        ],
        [
         "39",
         "02-01-2018",
         "16:00",
         "1.29033",
         "R",
         "ugm-3",
         "19.09323",
         "R",
         "ugm-3",
         "21.0717",
         "R",
         "ugm-3"
        ],
        [
         "40",
         "02-01-2018",
         "17:00",
         "1.3218",
         "R",
         "ugm-3",
         "21.35949",
         "R",
         "ugm-3",
         "23.38621",
         "R",
         "ugm-3"
        ],
        [
         "41",
         "02-01-2018",
         "18:00",
         "1.16444",
         "R",
         "ugm-3",
         "22.66158",
         "R",
         "ugm-3",
         "24.44703",
         "R",
         "ugm-3"
        ],
        [
         "42",
         "02-01-2018",
         "19:00",
         "1.47915",
         "R",
         "ugm-3",
         "27.91709",
         "R",
         "ugm-3",
         "30.18509",
         "R",
         "ugm-3"
        ],
        [
         "43",
         "02-01-2018",
         "20:00",
         "1.16444",
         "R",
         "ugm-3",
         "29.36402",
         "R",
         "ugm-3",
         "31.14947",
         "R",
         "ugm-3"
        ],
        [
         "44",
         "02-01-2018",
         "21:00",
         "0.75531",
         "R",
         "ugm-3",
         "19.33494",
         "R",
         "ugm-3",
         "20.49307",
         "R",
         "ugm-3"
        ],
        [
         "45",
         "02-01-2018",
         "22:00",
         "0.4406",
         "R",
         "ugm-3",
         "11.52383",
         "R",
         "ugm-3",
         "12.19941",
         "R",
         "ugm-3"
        ],
        [
         "46",
         "02-01-2018",
         "23:00",
         "0.56649",
         "R",
         "ugm-3",
         "14.8508",
         "R",
         "ugm-3",
         "15.71939",
         "R",
         "ugm-3"
        ],
        [
         "47",
         "02-01-2018",
         "24:00",
         "0.25177",
         "R",
         "ugm-3",
         "3.80901",
         "R",
         "ugm-3",
         "4.19505",
         "R",
         "ugm-3"
        ],
        [
         "48",
         "03-01-2018",
         "01:00",
         "0.04198",
         "R",
         "ugm-3",
         "1.86533",
         "R",
         "ugm-3",
         "1.9297",
         "R",
         "ugm-3"
        ],
        [
         "49",
         "03-01-2018",
         "02:00",
         "0.0",
         "R",
         "ugm-3",
         "4.50262",
         "R",
         "ugm-3",
         "4.50262",
         "R",
         "ugm-3"
        ]
       ],
       "shape": {
        "columns": 11,
        "rows": 8760
       }
      },
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>time</th>\n",
       "      <th>Nitric oxide</th>\n",
       "      <th>status</th>\n",
       "      <th>unit</th>\n",
       "      <th>Nitrogen dioxide</th>\n",
       "      <th>status.1</th>\n",
       "      <th>unit.1</th>\n",
       "      <th>Nitrogen oxides as nitrogen dioxide</th>\n",
       "      <th>status.2</th>\n",
       "      <th>unit.2</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>01:00</td>\n",
       "      <td>0.25166</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.75500</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>5.14087</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>02:00</td>\n",
       "      <td>0.12583</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>6.87575</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>7.06869</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>03:00</td>\n",
       "      <td>0.28312</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>5.78313</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>6.21723</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>04:00</td>\n",
       "      <td>0.22020</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>3.75899</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.09663</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>05:00</td>\n",
       "      <td>0.18874</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>3.27707</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>3.56647</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>20:00</td>\n",
       "      <td>0.28836</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>12.08703</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>12.52918</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>21:00</td>\n",
       "      <td>0.18023</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>8.29340</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>8.56974</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>22:00</td>\n",
       "      <td>0.10814</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>5.52928</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>5.69508</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>23:00</td>\n",
       "      <td>0.07209</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.77096</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.88150</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>24:00</td>\n",
       "      <td>0.00000</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.17640</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>4.17640</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows  11 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Date   time  Nitric oxide status   unit  Nitrogen dioxide  \\\n",
       "0     01-01-2018  01:00       0.25166      R  ugm-3           4.75500   \n",
       "1     01-01-2018  02:00       0.12583      R  ugm-3           6.87575   \n",
       "2     01-01-2018  03:00       0.28312      R  ugm-3           5.78313   \n",
       "3     01-01-2018  04:00       0.22020      R  ugm-3           3.75899   \n",
       "4     01-01-2018  05:00       0.18874      R  ugm-3           3.27707   \n",
       "...          ...    ...           ...    ...    ...               ...   \n",
       "8755  31-12-2018  20:00       0.28836      R  ugm-3          12.08703   \n",
       "8756  31-12-2018  21:00       0.18023      R  ugm-3           8.29340   \n",
       "8757  31-12-2018  22:00       0.10814      R  ugm-3           5.52928   \n",
       "8758  31-12-2018  23:00       0.07209      R  ugm-3           4.77096   \n",
       "8759  31-12-2018  24:00       0.00000      R  ugm-3           4.17640   \n",
       "\n",
       "     status.1 unit.1  Nitrogen oxides as nitrogen dioxide status.2 unit.2  \n",
       "0           R  ugm-3                              5.14087        R  ugm-3  \n",
       "1           R  ugm-3                              7.06869        R  ugm-3  \n",
       "2           R  ugm-3                              6.21723        R  ugm-3  \n",
       "3           R  ugm-3                              4.09663        R  ugm-3  \n",
       "4           R  ugm-3                              3.56647        R  ugm-3  \n",
       "...       ...    ...                                  ...      ...    ...  \n",
       "8755        R  ugm-3                             12.52918        R  ugm-3  \n",
       "8756        R  ugm-3                              8.56974        R  ugm-3  \n",
       "8757        R  ugm-3                              5.69508        R  ugm-3  \n",
       "8758        R  ugm-3                              4.88150        R  ugm-3  \n",
       "8759        R  ugm-3                              4.17640        R  ugm-3  \n",
       "\n",
       "[8760 rows x 11 columns]"
      ]
     },
     "execution_count": 15,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "obsaq.read_sites('BDMP', 'aurn', year=2018)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "### Read data by a point of longitude and latitude\n",
    "\n",
    "Users can give a point of longitude and latitude to read the station data."
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Load the ObsAQ package and Define the point"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [],
   "source": [
    "import obsaq\n",
    "\n",
    "lon = 0.0\n",
    "lat = 55.0\n",
    "point = [lon, lat]"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Get the station metadata\n",
    "\n",
    "NOTE: This is the all station information and the next step will choose the stations by point."
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.microsoft.datawrangler.viewer.v0+json": {
       "columns": [
        {
         "name": "index",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "site_id",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "site_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "location_type",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "latitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "longitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "parameter",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "Parameter_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "start_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "end_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "ratified_to",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "zone",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "agglomeration",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "local_authority",
         "rawType": "object",
         "type": "string"
        }
       ],
       "ref": "b2a2e056-8be9-4ddd-927f-e7ddbc368204",
       "rows": [
        [
         "0",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "O3",
         "Ozone",
         "2003-08-01",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "1",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "NO",
         "Nitric oxide",
         "1999-09-18",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "2",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "NO2",
         "Nitrogen dioxide",
         "1999-09-18",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "3",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "NOXasNO2",
         "Nitrogen oxides as nitrogen dioxide",
         "1999-09-18",
         "2021-09-20",
         "2021-09-20",
         "North East Scotland",
         null,
         "Aberdeen City"
        ],
        [
         "4",
         "ABD",
         "Aberdeen",
         "Urban Background",
         "57.15736",
         "-2.094278",
         "SO2",
         "Sulphur dioxide",
         "2001-01-01",
         "2007-09-30",
         "2007-09-30",
         "North East Scotland",
         null,
         "Aberdeen City"
        ]
       ],
       "shape": {
        "columns": 13,
        "rows": 5
       }
      },
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>site_id</th>\n",
       "      <th>site_name</th>\n",
       "      <th>location_type</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>parameter</th>\n",
       "      <th>Parameter_name</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>ratified_to</th>\n",
       "      <th>zone</th>\n",
       "      <th>agglomeration</th>\n",
       "      <th>local_authority</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>O3</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>2003-08-01</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NO</td>\n",
       "      <td>Nitric oxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NO2</td>\n",
       "      <td>Nitrogen dioxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>NOXasNO2</td>\n",
       "      <td>Nitrogen oxides as nitrogen dioxide</td>\n",
       "      <td>1999-09-18</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>2021-09-20</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>ABD</td>\n",
       "      <td>Aberdeen</td>\n",
       "      <td>Urban Background</td>\n",
       "      <td>57.15736</td>\n",
       "      <td>-2.094278</td>\n",
       "      <td>SO2</td>\n",
       "      <td>Sulphur dioxide</td>\n",
       "      <td>2001-01-01</td>\n",
       "      <td>2007-09-30</td>\n",
       "      <td>2007-09-30</td>\n",
       "      <td>North East Scotland</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Aberdeen City</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "  site_id site_name     location_type  latitude  longitude parameter  \\\n",
       "0     ABD  Aberdeen  Urban Background  57.15736  -2.094278        O3   \n",
       "1     ABD  Aberdeen  Urban Background  57.15736  -2.094278        NO   \n",
       "2     ABD  Aberdeen  Urban Background  57.15736  -2.094278       NO2   \n",
       "3     ABD  Aberdeen  Urban Background  57.15736  -2.094278  NOXasNO2   \n",
       "4     ABD  Aberdeen  Urban Background  57.15736  -2.094278       SO2   \n",
       "\n",
       "                        Parameter_name  start_date    end_date ratified_to  \\\n",
       "0                                Ozone  2003-08-01  2021-09-20  2021-09-20   \n",
       "1                         Nitric oxide  1999-09-18  2021-09-20  2021-09-20   \n",
       "2                     Nitrogen dioxide  1999-09-18  2021-09-20  2021-09-20   \n",
       "3  Nitrogen oxides as nitrogen dioxide  1999-09-18  2021-09-20  2021-09-20   \n",
       "4                      Sulphur dioxide  2001-01-01  2007-09-30  2007-09-30   \n",
       "\n",
       "                  zone agglomeration local_authority  \n",
       "0  North East Scotland           NaN   Aberdeen City  \n",
       "1  North East Scotland           NaN   Aberdeen City  \n",
       "2  North East Scotland           NaN   Aberdeen City  \n",
       "3  North East Scotland           NaN   Aberdeen City  \n",
       "4  North East Scotland           NaN   Aberdeen City  "
      ]
     },
     "execution_count": 17,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "meta = obsaq.meta()\n",
    "site_table = meta.get_metadata('aurn')\n",
    "\n",
    "site_table.head(5)"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Choose the stations by point"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": 18,
   "metadata": {},
   "outputs": [
    {
     "name": "stdout",
     "output_type": "stream",
     "text": [
      "Site is selected by point: [0.0, 55.0]\n"
     ]
    },
    {
     "data": {
      "application/vnd.microsoft.datawrangler.viewer.v0+json": {
       "columns": [
        {
         "name": "index",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "site_id",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "site_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "location_type",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "latitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "longitude",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "parameter",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "Parameter_name",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "start_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "end_date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "ratified_to",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "zone",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "agglomeration",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "local_authority",
         "rawType": "object",
         "type": "string"
        }
       ],
       "ref": "400fa4fd-9994-44b9-8333-f715ca345224",
       "rows": [
        [
         "1267",
         "HM",
         "High Muffles",
         "Rural Background",
         "54.334497",
         "-0.80882",
         "O3",
         "Ozone",
         "1987-07-16",
         "ongoing",
         "2025-09-30",
         "Yorkshire & Humberside",
         null,
         "Ryedale"
        ]
       ],
       "shape": {
        "columns": 13,
        "rows": 1
       }
      },
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>site_id</th>\n",
       "      <th>site_name</th>\n",
       "      <th>location_type</th>\n",
       "      <th>latitude</th>\n",
       "      <th>longitude</th>\n",
       "      <th>parameter</th>\n",
       "      <th>Parameter_name</th>\n",
       "      <th>start_date</th>\n",
       "      <th>end_date</th>\n",
       "      <th>ratified_to</th>\n",
       "      <th>zone</th>\n",
       "      <th>agglomeration</th>\n",
       "      <th>local_authority</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>1267</th>\n",
       "      <td>HM</td>\n",
       "      <td>High Muffles</td>\n",
       "      <td>Rural Background</td>\n",
       "      <td>54.334497</td>\n",
       "      <td>-0.80882</td>\n",
       "      <td>O3</td>\n",
       "      <td>Ozone</td>\n",
       "      <td>1987-07-16</td>\n",
       "      <td>ongoing</td>\n",
       "      <td>2025-09-30</td>\n",
       "      <td>Yorkshire &amp; Humberside</td>\n",
       "      <td>NaN</td>\n",
       "      <td>Ryedale</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "</div>"
      ],
      "text/plain": [
       "     site_id     site_name     location_type   latitude  longitude parameter  \\\n",
       "1267      HM  High Muffles  Rural Background  54.334497   -0.80882        O3   \n",
       "\n",
       "     Parameter_name  start_date end_date ratified_to                    zone  \\\n",
       "1267          Ozone  1987-07-16  ongoing  2025-09-30  Yorkshire & Humberside   \n",
       "\n",
       "     agglomeration local_authority  \n",
       "1267           NaN         Ryedale  "
      ]
     },
     "execution_count": 18,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "final_sites = meta.get_site(point=point)\n",
    "final_sites"
   ]
  },
  {
   "cell_type": "markdown",
   "metadata": {},
   "source": [
    "#### Read the station data"
   ]
  },
  {
   "cell_type": "code",
   "execution_count": null,
   "metadata": {},
   "outputs": [
    {
     "data": {
      "application/vnd.microsoft.datawrangler.viewer.v0+json": {
       "columns": [
        {
         "name": "index",
         "rawType": "int64",
         "type": "integer"
        },
        {
         "name": "Date",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "time",
         "rawType": "object",
         "type": "string"
        },
        {
         "name": "Nitric oxide",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "status",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "unit",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "Nitrogen dioxide",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "status.1",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "unit.1",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "Nitrogen oxides as nitrogen dioxide",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "status.2",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "unit.2",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "Ozone",
         "rawType": "float64",
         "type": "float"
        },
        {
         "name": "status.3",
         "rawType": "object",
         "type": "unknown"
        },
        {
         "name": "unit.3",
         "rawType": "object",
         "type": "unknown"
        }
       ],
       "ref": "1e8f4075-0e4c-48f4-b305-ddd4366f1767",
       "rows": [
        [
         "0",
         "01-01-2018",
         "01:00",
         "0.36708",
         "R",
         "ugm-3",
         "1.00358",
         "R",
         "ugm-3",
         "1.56642",
         "R",
         "ugm-3",
         "65.32591",
         "R",
         "ugm-3"
        ],
        [
         "1",
         "01-01-2018",
         "02:00",
         "0.2855",
         "R",
         "ugm-3",
         "1.066",
         "R",
         "ugm-3",
         "1.50376",
         "R",
         "ugm-3",
         "65.8581",
         "R",
         "ugm-3"
        ],
        [
         "2",
         "01-01-2018",
         "03:00",
         "0.27531",
         "R",
         "ugm-3",
         "1.22261",
         "R",
         "ugm-3",
         "1.64474",
         "R",
         "ugm-3",
         "67.15531",
         "R",
         "ugm-3"
        ],
        [
         "3",
         "01-01-2018",
         "04:00",
         "0.24472",
         "R",
         "ugm-3",
         "1.26951",
         "R",
         "ugm-3",
         "1.64474",
         "R",
         "ugm-3",
         "66.40692",
         "R",
         "ugm-3"
        ],
        [
         "4",
         "01-01-2018",
         "05:00",
         "0.3059",
         "R",
         "ugm-3",
         "2.16255",
         "R",
         "ugm-3",
         "2.63159",
         "R",
         "ugm-3",
         "66.20735",
         "R",
         "ugm-3"
        ],
        [
         "5",
         "01-01-2018",
         "06:00",
         "0.3059",
         "R",
         "ugm-3",
         "2.30353",
         "R",
         "ugm-3",
         "2.77256",
         "R",
         "ugm-3",
         "62.41552",
         "R",
         "ugm-3"
        ],
        [
         "6",
         "01-01-2018",
         "07:00",
         "0.21413",
         "R",
         "ugm-3",
         "0.98747",
         "R",
         "ugm-3",
         "1.31579",
         "R",
         "ugm-3",
         "63.76262",
         "R",
         "ugm-3"
        ],
        [
         "7",
         "01-01-2018",
         "08:00",
         "0.18354",
         "R",
         "ugm-3",
         "1.03437",
         "R",
         "ugm-3",
         "1.31579",
         "R",
         "ugm-3",
         "67.45466",
         "R",
         "ugm-3"
        ],
        [
         "8",
         "01-01-2018",
         "09:00",
         "0.3059",
         "R",
         "ugm-3",
         "1.50465",
         "R",
         "ugm-3",
         "1.97369",
         "R",
         "ugm-3",
         "66.45681",
         "R",
         "ugm-3"
        ],
        [
         "9",
         "01-01-2018",
         "10:00",
         "0.45885",
         "R",
         "ugm-3",
         "2.53894",
         "R",
         "ugm-3",
         "3.24249",
         "R",
         "ugm-3",
         "63.51315",
         "R",
         "ugm-3"
        ],
        [
         "10",
         "01-01-2018",
         "11:00",
         "0.52003",
         "R",
         "ugm-3",
         "4.23085",
         "R",
         "ugm-3",
         "5.02821",
         "R",
         "ugm-3",
         "58.42412",
         "R",
         "ugm-3"
        ],
        [
         "11",
         "01-01-2018",
         "12:00",
         "0.45885",
         "R",
         "ugm-3",
         "5.59345",
         "R",
         "ugm-3",
         "6.29701",
         "R",
         "ugm-3",
         "56.07917",
         "R",
         "ugm-3"
        ],
        [
         "12",
         "01-01-2018",
         "13:00",
         "0.45885",
         "R",
         "ugm-3",
         "6.43932",
         "R",
         "ugm-3",
         "7.14287",
         "R",
         "ugm-3",
         "52.68648",
         "R",
         "ugm-3"
        ],
        [
         "13",
         "01-01-2018",
         "14:00",
         "0.85651",
         "R",
         "ugm-3",
         "10.7168",
         "R",
         "ugm-3",
         "12.0301",
         "R",
         "ugm-3",
         "49.59315",
         "R",
         "ugm-3"
        ],
        [
         "14",
         "01-01-2018",
         "15:00",
         "0.45885",
         "R",
         "ugm-3",
         "12.2664",
         "R",
         "ugm-3",
         "12.96995",
         "R",
         "ugm-3",
         "44.45422",
         "R",
         "ugm-3"
        ],
        [
         "15",
         "01-01-2018",
         "16:00",
         "0.24472",
         "R",
         "ugm-3",
         "10.52705",
         "R",
         "ugm-3",
         "10.90228",
         "R",
         "ugm-3",
         "42.75787",
         "R",
         "ugm-3"
        ],
        [
         "16",
         "01-01-2018",
         "17:00",
         "0.27531",
         "R",
         "ugm-3",
         "10.48015",
         "R",
         "ugm-3",
         "10.90228",
         "R",
         "ugm-3",
         "48.5953",
         "R",
         "ugm-3"
        ],
        [
         "17",
         "01-01-2018",
         "18:00",
         "0.45885",
         "R",
         "ugm-3",
         "10.57467",
         "R",
         "ugm-3",
         "11.27822",
         "R",
         "ugm-3",
         "46.5497",
         "R",
         "ugm-3"
        ],
        [
         "18",
         "01-01-2018",
         "19:00",
         "0.33649",
         "R",
         "ugm-3",
         "3.76039",
         "R",
         "ugm-3",
         "4.27633",
         "R",
         "ugm-3",
         "45.70153",
         "R",
         "ugm-3"
        ],
        [
         "19",
         "01-01-2018",
         "20:00",
         "0.33649",
         "R",
         "ugm-3",
         "2.86753",
         "R",
         "ugm-3",
         "3.38347",
         "R",
         "ugm-3",
         "60.61939",
         "R",
         "ugm-3"
        ],
        [
         "20",
         "01-01-2018",
         "21:00",
         "0.3059",
         "R",
         "ugm-3",
         "2.25653",
         "R",
         "ugm-3",
         "2.72557",
         "R",
         "ugm-3",
         "60.5196",
         "R",
         "ugm-3"
        ],
        [
         "21",
         "01-01-2018",
         "22:00",
         "0.33649",
         "R",
         "ugm-3",
         "1.03482",
         "R",
         "ugm-3",
         "1.55076",
         "R",
         "ugm-3",
         "61.76692",
         "R",
         "ugm-3"
        ],
        [
         "22",
         "01-01-2018",
         "23:00",
         "0.3059",
         "R",
         "ugm-3",
         "0.98773",
         "R",
         "ugm-3",
         "1.45677",
         "R",
         "ugm-3",
         "65.70842",
         "R",
         "ugm-3"
        ],
        [
         "23",
         "01-01-2018",
         "24:00",
         "0.3059",
         "R",
         "ugm-3",
         "1.12871",
         "R",
         "ugm-3",
         "1.59775",
         "R",
         "ugm-3",
         "66.20735",
         "R",
         "ugm-3"
        ],
        [
         "24",
         "02-01-2018",
         "01:00",
         "0.32633",
         "R",
         "ugm-3",
         "0.87811",
         "R",
         "ugm-3",
         "1.37848",
         "R",
         "ugm-3",
         "64.46111",
         "R",
         "ugm-3"
        ],
        [
         "25",
         "02-01-2018",
         "02:00",
         "0.16316",
         "R",
         "ugm-3",
         "0.56437",
         "R",
         "ugm-3",
         "0.81455",
         "R",
         "ugm-3",
         "65.39244",
         "R",
         "ugm-3"
        ],
        [
         "26",
         "02-01-2018",
         "03:00",
         "0.15297",
         "R",
         "ugm-3",
         "0.42336",
         "R",
         "ugm-3",
         "0.65791",
         "R",
         "ugm-3",
         "66.75617",
         "R",
         "ugm-3"
        ],
        [
         "27",
         "02-01-2018",
         "04:00",
         "0.27534",
         "R",
         "ugm-3",
         "0.4237",
         "R",
         "ugm-3",
         "0.84588",
         "R",
         "ugm-3",
         "67.45466",
         "R",
         "ugm-3"
        ],
        [
         "28",
         "02-01-2018",
         "05:00",
         "0.24475",
         "R",
         "ugm-3",
         "0.61159",
         "R",
         "ugm-3",
         "0.98686",
         "R",
         "ugm-3",
         "65.60864",
         "R",
         "ugm-3"
        ],
        [
         "29",
         "02-01-2018",
         "06:00",
         "0.15297",
         "R",
         "ugm-3",
         "0.79931",
         "R",
         "ugm-3",
         "1.03386",
         "R",
         "ugm-3",
         "61.66713",
         "R",
         "ugm-3"
        ],
        [
         "30",
         "02-01-2018",
         "07:00",
         "0.18356",
         "R",
         "ugm-3",
         "0.79939",
         "R",
         "ugm-3",
         "1.08085",
         "R",
         "ugm-3",
         "62.06627",
         "R",
         "ugm-3"
        ],
        [
         "31",
         "02-01-2018",
         "08:00",
         "0.36712",
         "R",
         "ugm-3",
         "1.64578",
         "R",
         "ugm-3",
         "2.20869",
         "R",
         "ugm-3",
         "57.67573",
         "R",
         "ugm-3"
        ],
        [
         "32",
         "02-01-2018",
         "09:00",
         "0.30593",
         "R",
         "ugm-3",
         "6.10999",
         "R",
         "ugm-3",
         "6.57908",
         "R",
         "ugm-3",
         "54.68218",
         "R",
         "ugm-3"
        ],
        [
         "33",
         "02-01-2018",
         "10:00",
         "0.70365",
         "R",
         "ugm-3",
         "10.85743",
         "R",
         "ugm-3",
         "11.93634",
         "R",
         "ugm-3",
         "49.99229",
         "R",
         "ugm-3"
        ],
        [
         "34",
         "02-01-2018",
         "11:00",
         "0.55068",
         "R",
         "ugm-3",
         "12.92472",
         "R",
         "ugm-3",
         "13.76908",
         "R",
         "ugm-3",
         "46.05078",
         "R",
         "ugm-3"
        ],
        [
         "35",
         "02-01-2018",
         "12:00",
         "0.58127",
         "R",
         "ugm-3",
         "14.09964",
         "R",
         "ugm-3",
         "14.99091",
         "R",
         "ugm-3",
         "46.40003",
         "R",
         "ugm-3"
        ],
        [
         "36",
         "02-01-2018",
         "13:00",
         "0.52009",
         "R",
         "ugm-3",
         "12.07875",
         "R",
         "ugm-3",
         "12.87621",
         "R",
         "ugm-3",
         "47.04863",
         "R",
         "ugm-3"
        ],
        [
         "37",
         "02-01-2018",
         "14:00",
         "0.27534",
         "R",
         "ugm-3",
         "11.79612",
         "R",
         "ugm-3",
         "12.2183",
         "R",
         "ugm-3",
         "54.98154",
         "R",
         "ugm-3"
        ],
        [
         "38",
         "02-01-2018",
         "15:00",
         "0.21415",
         "R",
         "ugm-3",
         "13.39373",
         "R",
         "ugm-3",
         "13.72209",
         "R",
         "ugm-3",
         "53.43487",
         "R",
         "ugm-3"
        ],
        [
         "39",
         "02-01-2018",
         "16:00",
         "0.18356",
         "R",
         "ugm-3",
         "18.7039",
         "R",
         "ugm-3",
         "18.98536",
         "R",
         "ugm-3",
         "45.30239",
         "R",
         "ugm-3"
        ],
        [
         "40",
         "02-01-2018",
         "17:00",
         "0.30593",
         "R",
         "ugm-3",
         "17.24744",
         "R",
         "ugm-3",
         "17.71653",
         "R",
         "ugm-3",
         "38.21766",
         "R",
         "ugm-3"
        ],
        [
         "41",
         "02-01-2018",
         "18:00",
         "0.30593",
         "R",
         "ugm-3",
         "17.15345",
         "R",
         "ugm-3",
         "17.62254",
         "R",
         "ugm-3",
         "41.85981",
         "R",
         "ugm-3"
        ],
        [
         "42",
         "02-01-2018",
         "19:00",
         "0.33653",
         "R",
         "ugm-3",
         "13.39406",
         "R",
         "ugm-3",
         "13.91006",
         "R",
         "ugm-3",
         "42.75787",
         "R",
         "ugm-3"
        ],
        [
         "43",
         "02-01-2018",
         "20:00",
         "0.27534",
         "R",
         "ugm-3",
         "13.06494",
         "R",
         "ugm-3",
         "13.48712",
         "R",
         "ugm-3",
         "50.89035",
         "R",
         "ugm-3"
        ],
        [
         "44",
         "02-01-2018",
         "21:00",
         "0.36712",
         "R",
         "ugm-3",
         "9.54068",
         "R",
         "ugm-3",
         "10.10359",
         "R",
         "ugm-3",
         "50.39143",
         "R",
         "ugm-3"
        ],
        [
         "45",
         "02-01-2018",
         "22:00",
         "0.33653",
         "R",
         "ugm-3",
         "9.91655",
         "R",
         "ugm-3",
         "10.43255",
         "R",
         "ugm-3",
         "53.98369",
         "R",
         "ugm-3"
        ],
        [
         "46",
         "02-01-2018",
         "23:00",
         "0.36712",
         "R",
         "ugm-3",
         "4.70036",
         "R",
         "ugm-3",
         "5.26327",
         "R",
         "ugm-3",
         "55.48046",
         "R",
         "ugm-3"
        ],
        [
         "47",
         "02-01-2018",
         "24:00",
         "0.30593",
         "R",
         "ugm-3",
         "1.64561",
         "R",
         "ugm-3",
         "2.11471",
         "R",
         "ugm-3",
         "70.04907",
         "R",
         "ugm-3"
        ],
        [
         "48",
         "03-01-2018",
         "01:00",
         "0.32637",
         "R",
         "ugm-3",
         "1.69265",
         "R",
         "ugm-3",
         "2.19307",
         "R",
         "ugm-3",
         "76.30226",
         "R",
         "ugm-3"
        ],
        [
         "49",
         "03-01-2018",
         "02:00",
         "0.24478",
         "R",
         "ugm-3",
         "1.1285",
         "R",
         "ugm-3",
         "1.50382",
         "R",
         "ugm-3",
         "80.6928",
         "R",
         "ugm-3"
        ]
       ],
       "shape": {
        "columns": 14,
        "rows": 8760
       }
      },
      "text/html": [
       "<div>\n",
       "<style scoped>\n",
       "    .dataframe tbody tr th:only-of-type {\n",
       "        vertical-align: middle;\n",
       "    }\n",
       "\n",
       "    .dataframe tbody tr th {\n",
       "        vertical-align: top;\n",
       "    }\n",
       "\n",
       "    .dataframe thead th {\n",
       "        text-align: right;\n",
       "    }\n",
       "</style>\n",
       "<table border=\"1\" class=\"dataframe\">\n",
       "  <thead>\n",
       "    <tr style=\"text-align: right;\">\n",
       "      <th></th>\n",
       "      <th>Date</th>\n",
       "      <th>time</th>\n",
       "      <th>Nitric oxide</th>\n",
       "      <th>status</th>\n",
       "      <th>unit</th>\n",
       "      <th>Nitrogen dioxide</th>\n",
       "      <th>status.1</th>\n",
       "      <th>unit.1</th>\n",
       "      <th>Nitrogen oxides as nitrogen dioxide</th>\n",
       "      <th>status.2</th>\n",
       "      <th>unit.2</th>\n",
       "      <th>Ozone</th>\n",
       "      <th>status.3</th>\n",
       "      <th>unit.3</th>\n",
       "    </tr>\n",
       "  </thead>\n",
       "  <tbody>\n",
       "    <tr>\n",
       "      <th>0</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>01:00</td>\n",
       "      <td>0.36708</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.00358</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.56642</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>65.32591</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>1</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>02:00</td>\n",
       "      <td>0.28550</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.06600</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.50376</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>65.85810</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>2</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>03:00</td>\n",
       "      <td>0.27531</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.22261</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.64474</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>67.15531</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>3</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>04:00</td>\n",
       "      <td>0.24472</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.26951</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.64474</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>66.40692</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>4</th>\n",
       "      <td>01-01-2018</td>\n",
       "      <td>05:00</td>\n",
       "      <td>0.30590</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>2.16255</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>2.63159</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>66.20735</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>...</th>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "      <td>...</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8755</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>20:00</td>\n",
       "      <td>0.30417</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.38387</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.85025</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>70.34843</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8756</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>21:00</td>\n",
       "      <td>0.23657</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.27605</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.63879</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>70.39832</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8757</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>22:00</td>\n",
       "      <td>0.33796</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.17346</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.69166</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>69.89939</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8758</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>23:00</td>\n",
       "      <td>0.50694</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.44300</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>2.22030</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>68.85165</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "    <tr>\n",
       "      <th>8759</th>\n",
       "      <td>31-12-2018</td>\n",
       "      <td>24:00</td>\n",
       "      <td>0.40556</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>1.70419</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>2.32603</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "      <td>67.85380</td>\n",
       "      <td>R</td>\n",
       "      <td>ugm-3</td>\n",
       "    </tr>\n",
       "  </tbody>\n",
       "</table>\n",
       "<p>8760 rows  14 columns</p>\n",
       "</div>"
      ],
      "text/plain": [
       "            Date   time  Nitric oxide status   unit  Nitrogen dioxide  \\\n",
       "0     01-01-2018  01:00       0.36708      R  ugm-3           1.00358   \n",
       "1     01-01-2018  02:00       0.28550      R  ugm-3           1.06600   \n",
       "2     01-01-2018  03:00       0.27531      R  ugm-3           1.22261   \n",
       "3     01-01-2018  04:00       0.24472      R  ugm-3           1.26951   \n",
       "4     01-01-2018  05:00       0.30590      R  ugm-3           2.16255   \n",
       "...          ...    ...           ...    ...    ...               ...   \n",
       "8755  31-12-2018  20:00       0.30417      R  ugm-3           1.38387   \n",
       "8756  31-12-2018  21:00       0.23657      R  ugm-3           1.27605   \n",
       "8757  31-12-2018  22:00       0.33796      R  ugm-3           1.17346   \n",
       "8758  31-12-2018  23:00       0.50694      R  ugm-3           1.44300   \n",
       "8759  31-12-2018  24:00       0.40556      R  ugm-3           1.70419   \n",
       "\n",
       "     status.1 unit.1  Nitrogen oxides as nitrogen dioxide status.2 unit.2  \\\n",
       "0           R  ugm-3                              1.56642        R  ugm-3   \n",
       "1           R  ugm-3                              1.50376        R  ugm-3   \n",
       "2           R  ugm-3                              1.64474        R  ugm-3   \n",
       "3           R  ugm-3                              1.64474        R  ugm-3   \n",
       "4           R  ugm-3                              2.63159        R  ugm-3   \n",
       "...       ...    ...                                  ...      ...    ...   \n",
       "8755        R  ugm-3                              1.85025        R  ugm-3   \n",
       "8756        R  ugm-3                              1.63879        R  ugm-3   \n",
       "8757        R  ugm-3                              1.69166        R  ugm-3   \n",
       "8758        R  ugm-3                              2.22030        R  ugm-3   \n",
       "8759        R  ugm-3                              2.32603        R  ugm-3   \n",
       "\n",
       "         Ozone status.3 unit.3  \n",
       "0     65.32591        R  ugm-3  \n",
       "1     65.85810        R  ugm-3  \n",
       "2     67.15531        R  ugm-3  \n",
       "3     66.40692        R  ugm-3  \n",
       "4     66.20735        R  ugm-3  \n",
       "...        ...      ...    ...  \n",
       "8755  70.34843        R  ugm-3  \n",
       "8756  70.39832        R  ugm-3  \n",
       "8757  69.89939        R  ugm-3  \n",
       "8758  68.85165        R  ugm-3  \n",
       "8759  67.85380        R  ugm-3  \n",
       "\n",
       "[8760 rows x 14 columns]"
      ]
     },
     "execution_count": 19,
     "metadata": {},
     "output_type": "execute_result"
    }
   ],
   "source": [
    "obsaq.read_sites('HM', 'aurn', year=2018)"
   ]
  }
 ],
 "metadata": {
  "kernelspec": {
   "display_name": "obsaq39v2",
   "language": "python",
   "name": "python3"
  },
  "language_info": {
   "codemirror_mode": {
    "name": "ipython",
    "version": 3
   },
   "file_extension": ".py",
   "mimetype": "text/x-python",
   "name": "python",
   "nbconvert_exporter": "python",
   "pygments_lexer": "ipython3",
   "version": "3.9.20"
  }
 },
 "nbformat": 4,
 "nbformat_minor": 2
}
